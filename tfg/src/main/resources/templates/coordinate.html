{{> fragments/header}}
  <div class="container-fluid">
      <div class="row">
          <div class="col-lg-5">
            <div>
              <img id="img-hel" src="images\HelicopterPet.png">
              <img id="img-exp" src="images\exp-coor.png">
            </div>
          </div>
      <div class="col-lg-7">
        <div class="coor-juego">
          <h1 class="coor-titulo">¿Cuál es la respuesta correcta?</h1>
          <div id="coor-pregunta" class="coor-pregunta"></div>
          <div class="coor-grid" id="coor-grid"></div>
          <div class="coor-opciones">
            <button class="coor-boton" onclick="verificarRespuesta(this)"></button>
            <button class="coor-boton" onclick="verificarRespuesta(this)"></button>
            <button class="coor-boton" onclick="verificarRespuesta(this)"></button>
            <button class="coor-boton" onclick="verificarRespuesta(this)"></button>
          </div>
        </div>
      </div>

  </div>

  </div>

  <script>
    const size = 5;
    let respuestaCorrecta = "";

    function generarJuego() {
      const grid = document.getElementById("coor-grid");
      grid.innerHTML = "";

      const coordenadaAvionX = Math.floor(Math.random() * size);
      const coordenadaAvionY = Math.floor(Math.random() * size);

      let coordenadaTorreX, coordenadaTorreY;
      do {
        coordenadaTorreX = Math.floor(Math.random() * size);
        coordenadaTorreY = Math.floor(Math.random() * size);
      } while (coordenadaTorreX === coordenadaAvionX && coordenadaTorreY === coordenadaAvionY);

      for (let y = 0; y < size; y++) {
        for (let x = 0; x < size; x++) {
          const cell = document.createElement("div");
          cell.className = "coor-celda";
          if (x === coordenadaAvionX && y === coordenadaAvionY) {
            cell.textContent = "✈️";
          } else if (x === coordenadaTorreX && y === coordenadaTorreY) {
            cell.textContent = "🏁";
          }
          grid.appendChild(cell);
        }
      }

      const dx = coordenadaTorreX - coordenadaAvionX;
      const dy = coordenadaTorreY - coordenadaAvionY;

      document.getElementById("coor-pregunta").textContent = "¿Qué distancia hay desde el avión hasta la meta?";
      const distancia = calcularDistanciaMN(dx, dy);
      respuestaCorrecta = distancia.toString();

      const opciones = generarOpcionesDistancia(distancia);
      asignarOpciones(opciones);
    }

    function calcularDistanciaMN(dx, dy) {
      const pasosHoriz = Math.abs(dx);
      const pasosVert = Math.abs(dy);
      const diagonales = Math.min(pasosHoriz, pasosVert);
      const rectos = Math.abs(pasosHoriz - pasosVert);
      return diagonales * 14 + rectos * 10;
    }

    function generarOpcionesDistancia(correcta) {
      const opciones = new Set([correcta]);
      while (opciones.size < 4) {
        const variacion = (Math.floor(Math.random() * 5) - 2) * 10;
        const nueva = parseInt(correcta) + variacion;
        if (nueva > 0) opciones.add(nueva.toString());
      }
      return Array.from(opciones).sort(() => Math.random() - 0.5);
    }

    function asignarOpciones(opciones) {
      document.querySelectorAll(".coor-boton").forEach((btn, i) => {
        btn.textContent = opciones[i];
      });
    }

    function verificarRespuesta(boton) {
      if (boton.textContent === respuestaCorrecta) {
        alert("¡Correcto! 🎉");
      } else {
        alert(`¡Incorrecto! Era ${respuestaCorrecta}.`);
      }
      generarJuego();
    }

    generarJuego();
  </script>
  {{> fragments/footer}}